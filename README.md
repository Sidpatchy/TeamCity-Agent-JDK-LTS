# TeamCity Agent with JDK LTS
This is a Docker image building on top of Jetbrains' upstream image. It adds the following:
- Adoptium Temurin JDK 8
- Adoptium Temurin JDK 11
- Adoptium Temurin JDK 17
- Adoptium Temurin JDK 21

Addtionally, it overrides the default Java distribution that Jetbrains ships and replaces it with Adoptium Temurin 21.

## Usage
This image retains all upstream environment variables. At the time of writing this readme this includes the following:

| Variable | Description |
|----------|-------------|
| `SERVER_URL` | URL of the TeamCity server agent will connect to |
| `AGENT_NAME` | (optional) Name of the agent in TeamCity UI, autogenerated if omitted |
| `AGENT_TOKEN` | (optional) Agent authorization token, if unset, the agent should be authorized via TeamCity UI |
| `OWN_ADDRESS` | (optional, Linux-only) IP address build agent binds to, autodetected |
| `OWN_PORT` | (optional, Linux-only) Port build agent binds to, 9090 by default |
| `DOCKER_IN_DOCKER` | (optional, Linux-only) Run Docker within Docker |

*These are subject to change at any time. Please verify upstream for any changes: https://hub.docker.com/r/jetbrains/teamcity-agent*

This repo includes a Docker Compose file for ease of use [here](https://github.com/Sidpatchy/TeamCity-Agent-JDK-LTS/blob/main/docker-compose.yml). This is an absolute bare-minimum configuration.

To start from the commandline you can execute the following command:
```bash
docker run -e SERVER_URL="<url to TeamCity server>"  \ 
    -v <path to agent config folder>:/data/teamcity_agent/conf  \      
    ghcr.io/sidpatchy/teamcity-agent-jdk-lts:main
```